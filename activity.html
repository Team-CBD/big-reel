<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOpL4ut22yVDXSPOcY6AiqvoHuX_Auah4&libraries=visualization">
  </script>
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./public/assets/css/styles.css">
</head>

<body>
    <nav>
        <div class="nav-wrapper rbagreen">
            <a href="#" class="brand-logo">Reel-Big</a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
                <!-- <li><a href="sass.html">Sass</a></li>
            <li><a href="badges.html">Components</a></li>
            <li><a href="collapsible.html">JavaScript</a></li> -->
            </ul>
        </div>
    </nav>

    
    <!-- Google Maps Container -->
    <div class="center" id="googleMap" style="width:100%;height:400px;"></div>
  
    <!-- Form -->
    <div class="container-fluid">
      <form>
        <div class="form-group">
          <label for="formGroupExampleInput">Fish Type</label>
          <input type="text" class="form-control" id="fishType" placeholder="Example input">
        </div>
        <div class="form-group">
          <label for="formGroupExampleInput2">Bait Type</label>
          <input type="text" class="form-control" id="baitType" placeholder="Another input">
        </div>
          </form>
    </div>
  
  <!-- Submit Button -->
    <button id="fishLocationSubmitButton" type="button" class="btn rbared" onclick="fishDataSubmit()">Submit</button>
  
  <div class="row"> </div>

    <div class="container">
    <div class="row">

        <div class="col s3">

            <div class="card blue-grey darken-1">
                <div class="card-content white-text">
                    <span class="card-title" id="fishimage">Fish</span>
                </div>
            </div>
           
        </div>

        <div class="col s4">

            <div class="card blue-grey darken-1">
                <div class="card-content white-text">
                    <span class="card-title" id="gear">Gear</span>
                </div>
            </div>

        </div>

        <div class="col s2">

            <div class="card blue-grey darken-1">
               <div class="card-content white-text">
                    <span class="card-title" id="time">Time</span>
               </div>
            </div>
        </div>

        <div class="col s3">

            <div class="card blue-grey darken-1">
                <div class="card-content white-text">
                    <span class="card-title" id="location">Location</span>
                </div>
            </div>

        </div>

    </div>
    </div>
    <!--JavaScript at end of body for optimized loading-->

    <script type="text/javascript" src="js/materialize.min.js"></script>

    <!-- SCRIPTS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
    </script>
  
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOpL4ut22yVDXSPOcY6AiqvoHuX_Auah4&libraries=visualization">
    </script>
    <script>
  
      var map, infoWindow;
      map = new google.maps.Map(document.getElementById("googleMap"), {
        center: {
          lat: "",
          lng: ""
        },
        zoom: 15
      });
      infoWindow = new google.maps.InfoWindow;
      // Try HTML5 geolocation.
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function (position) {
          var pos = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };
              map.setCenter(pos);
        }, function () {
          handleLocationError(true, infoWindow, map.getCenter());
        });
      } else {
        // Browser doesn't support Geolocation
        handleLocationError(false, infoWindow, map.getCenter());
      }
  
      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
          'Error: The Geolocation service failed.' :
          'Error: Your browser doesn\'t support geolocation.');
        infoWindow.open(map);
      }
  
   // Handle Submit Function for creating Google Maps Markers on current location
      function fishDataSubmit() {
        console.log('fishlocationbutton triggered!');
  
        navigator.geolocation.getCurrentPosition(function (position) {
          // get CURRENT location
          var currentPosition = {
            lat: position.coords.latitude,
            lng: position.coords.longitude
          };
  
          // Get information for the form and add a popup tip window
          // Use jquery to grab the form element and get the data
          var fishType = $("#fishType").val();
          var baitType = $("#baitType").val();
  
          // create a new google Maps marker
          var newMarker = new google.maps.Marker({
            position: currentPosition,
            map: map,
          }).addListener('click', function () {
            map.setCenter(this.getPosition())
            infoWindow.setPosition(this.getPosition());
            infoWindow.setContent(`{USER_HERE} has caught: ${fishType} using bait: ${baitType}!`);
            infoWindow.open(map, this);
          })
  
          // add our new marker to the marker array
       
          fishingMarkers.push(newMarker);
        })
  
      }
  

  
    </script>

</body>

</html>